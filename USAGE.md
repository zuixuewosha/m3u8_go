# M3U8下载器使用说明

## 快速开始

1. 双击运行 `start.bat` 文件启动程序
2. 在界面中输入M3U8链接
3. 选择下载位置
4. 设置线程数和重试次数
5. 点击"开始下载"
6. 可以添加多个下载任务并在任务列表中管理它们
7. 程序支持断点续传，意外中断后重启可继续下载

## 详细使用步骤

### 1. 启动程序
- 双击 `start.bat` 文件，或者
- 在命令行中运行 `python main.py`

### 2. 合并TS片段（下载完成后）
- 双击 `merge.bat` 文件，按照提示操作，或者
- 在命令行中运行 `python merge_ts.py -d 下载目录 -o output.mp4`

### 2. 输入M3U8链接或选择本地文件
- 在"**M3U8链接/文件**"输入框中粘贴要下载的M3U8链接或选择本地M3U8文件
- 确保链接是完整的URL，以http://或https://开头
- 或者点击"**选择文件**"按钮选择本地的M3U8文件

### 3. 选择下载位置
- 点击"**浏览**"按钮选择文件保存的目录
- 或者直接在输入框中输入路径

### 4. 设置下载参数
- **线程数**：设置同时下载的线程数量（建议5-20）
- **重试次数**：设置下载失败时的重试次数（建议3-5）

### 5. 开始下载
- 点击"**开始下载**"按钮开始下载任务
- 下载过程中可以随时点击"**停止下载**"来中断任务

### 6. 查看下载进度
- 进度条会显示当前下载进度
- 状态栏显示当前下载状态
- 日志框显示详细下载信息

### 7. 管理多个下载任务
- 可以添加多个下载任务，它们会同时进行
- 在任务列表中可以查看每个任务的状态、进度、速度和剩余时间
- 可以对每个任务进行单独操作：开始、停止、移除

### 8. 断点续传功能
- 程序会自动保存未完成的下载任务信息
- 如果程序意外中断或关闭，重启后会自动恢复未完成的任务
- 已下载的部分TS片段会被保留，避免重复下载
- 任务列表状态会在程序重启后恢复

## 合并下载的TS片段

下载完成后，可以使用项目提供的合并工具将TS片段合并为完整视频：

```bash
python merge_ts.py -d 下载目录 -o output.mp4
```

工具会自动检测下载目录中的所有TS片段，并按正确的顺序合并为MP4视频文件。

## 常见问题解决

### 1. 程序无法启动
- 确保已安装所有依赖：`pip install -r requirements.txt`
- 检查Python环境是否正确

### 2. 下载失败
- 检查M3U8链接是否有效
- 增加重试次数
- 减少线程数避免服务器拒绝连接

### 3. 下载速度慢
- 适当增加线程数
- 检查网络连接
- 尝试在不同时间下载

### 4. 合并TS片段失败
- 确保已安装FFmpeg（可选，工具会自动选择合并方法）
- 检查TS片段是否完整下载
- 确认输出目录有写入权限

## 技术支持

如果遇到问题，请检查：
1. Python环境是否正确安装
2. 所有依赖是否已安装
3. M3U8链接是否有效
4. 网络连接是否正常

## 免责声明

本工具仅供学习交流使用，请遵守相关法律法规，不要用于非法用途。